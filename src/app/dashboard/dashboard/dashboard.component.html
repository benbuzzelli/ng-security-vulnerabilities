<div class = "container">
    <!-- <input type="url" #url placeholder="https://github.com/"> -->
    <!-- <button mat-stroked-button color="primary" (click)="runTest()"> Run Test </button> -->
    <div class="center">
        <!-- <button mat-stroked-button color="primary" (click)="addPrediction()"> Add Prediction </button> -->
        <div style="width: 100%; min-width: 500px;" class="center">
            <input type="url" #commit placeholder="Enter github repository link...">
            <button mat-stroked-button color="primary" (click)="getPrediction(commit.value)"> Get Prediction </button>
        </div>
        <br>
        <p>
            {{prediction}}
        </p>
        <!-- <mat-form-field appearance="fill">
            <mat-label >Select an option</mat-label>
            <mat-select [(value)]="selected">
              <mat-option>None</mat-option>
              <mat-option value="option1">Skew 1</mat-option>
              <mat-option value="option2">Skew 2</mat-option>
              <mat-option value="option3">Skew 3</mat-option>
            </mat-select>
        </mat-form-field> -->
    </div>
    <br>
    <div *ngFor="let repo of repository$ | async">
        <!-- <div class="center">Show results for {{ prediction.repository }}</div> -->
        <table mat-table [dataSource]="repo.predictions" matSort>
            <!-- Position Column -->
            <ng-container matColumnDef="position">
                <th mat-header-cell *matHeaderCellDef> No. </th>
                <td mat-cell *matCellDef="let element; let i = index">{{i}} </td>
            </ng-container>
        
            <!-- File Column -->
            <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef> Date </th>
                <td mat-cell *matCellDef="let element" style="overflow:hidden">{{element.date}} </td>
            </ng-container>
        
        
            <!-- Commits Column -->
            <ng-container matColumnDef="commits">
                <th mat-header-cell *matHeaderCellDef> No. Commits </th>
                <td mat-cell *matCellDef="let element">{{element.numCommits}} </td>
            </ng-container>

            <ng-container matColumnDef="nonVulnerableCommits">
                <th mat-header-cell *matHeaderCellDef> No. Non Vulnerable </th>
                <td mat-cell *matCellDef="let element">{{element.numNonVulnerable}} </td>
            </ng-container>

            <ng-container matColumnDef="vulnerableCommits">
                <th mat-header-cell *matHeaderCellDef> No. Vulnerable </th>
                <td mat-cell *matCellDef="let element">{{element.numVulnerable}} </td>
            </ng-container>
        
            <!-- Severity Column -->
            <ng-container matColumnDef="severity">
                <th mat-header-cell *matHeaderCellDef> Severity </th>
                <td mat-cell *matCellDef="let element">{{element.isVulnerable}} </td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
    
    <mat-paginator [pageSizeOptions]="[1,5,10]" showFirstLastButtons></mat-paginator>
    
    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "pacman" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
    
    
    <div class="center" style="margin-top: 15px;">
        <button style="margin-right: 15px;" mat-stroked-button color="primary" (click)="DownloadPdf(dataSource)"> Convert to Pdf </button>
        <button mat-stroked-button color="primary" (click)="downloadCSV('ml-data')"> Download CSV </button>
    </div>
</div>
    <!-- <div class="card"> -->
    <!-- <input type="url" #message placeholder="https://github.com/"> 
    <button mat-stroked-button color="primary" (click)="addRepository(message.value)"> Run Test </button>
    <table class="table">
        <tr>
            <td data-title="commits">The number of commits used:</td>
           <td> 20 </td>
        </tr>
        <tr>
            <td data-title="severity"> The severity for this github is:</td>
            <td> Low </td>
        </tr> 
        <tr>
            <td data-title="vulnerability"> Is this guthub link vulnerabile:</td>
            <td> Yes </td>
        </tr>
    </table>  -->
    <!-- </div> -->
    <!-- <mat-expansion-panel hideToggle class="panel">
        <mat-expansion-panel-header>
            <div style="width: 100%;" class="center">
                <input type="url" #url placeholder="https://github.com/">
                <button mat-stroked-button color="primary" (click)="getUrl(url.value)"> Run Test </button>
            </div>
        </mat-expansion-panel-header>
        <mat-grid-list [class.mat-elevation-z4]="true" class="grid" cols="12" rowHeight="2:1">
            <mat-grid-tile class="grid-tile grid-tl" [colspan]="8" [rowspan]="4">
                <div style="width: 100%; padding: 10px; padding-top: 20px;">
                    <span class="grid-header">Test Complete</span><br>
                    <p><span class="grid-description">Ran test for:</span>&nbsp;<span class="grid-text">https://github.com/benbuzzelli/ng-security-vulnerabilities</span></p>
                </div>
            </mat-grid-tile>
            <mat-grid-tile class="grid-tile grid-tr grid-br" [colspan]="4" [rowspan]="6">
                <div #severityIconDiv class="image-icon-div">
                    <span class="grid-text-header">NOT VULNERABLE</span><br>
                    <mat-icon style="color: #76ff03;" [ngStyle]="scalables.severityIcon.style">verified</mat-icon>
                </div>
            </mat-grid-tile>
            <mat-grid-tile class="grid-tile grid-bl" [colspan]="4" [rowspan]="2">
                <span class="grid-description">Execution Time:</span><span class="grid-text">203 ms</span>
            </mat-grid-tile>
            <mat-grid-tile class="grid-tile" [colspan]="4" [rowspan]="2">
                <span class="grid-description">Commits tested:</span><span class="grid-text">85</span>
            </mat-grid-tile>
        </mat-grid-list>
    </mat-expansion-panel> -->


<!-- <div class = "container">
    <div class="card">
    <span>Enter Repository Json String</span>
    <input type="url" #json (keyup.enter)="addMLData(json.value)"><br>
    </div>
</div> -->
